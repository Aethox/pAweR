<!DOCTYPE html>
<html lang="en">
    <head>
        <title>Hello!</title>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
        <meta name="apple-mobile-web-app-capable" content="yes">
        <link rel="stylesheet" href="/style.css">
        <script src="https://aframe.io/releases/1.7.0/aframe.min.js"></script>
        <script src="https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/aframe-ar.js"></script>
    </head>  
    <body>
        <a-scene embedded arjs="trackingMethod: best; debugUIEnabled: false;" renderer="antialias: false; logarithmicDepthBuffer:true">
            <a-assets>
                <video id="pawer-logo" 
                       autoplay="true" 
                       playsinline 
                       preload="auto" 
                       src="Assets/pawerLogoMusic.mp4"
                       crossorigin="anonymous"
                       fetchpriority="high"></video>
            </a-assets>
            
            <a-marker type="pattern" url="Assets/paw2.patt" emitevents="true" smooth="true" smoothCount="10" smoothTolerance="0.01" smoothThreshold="5">
                <a-video id="video-entity" src="#pawer-logo" width="5" height="5" position="0 0 0" rotation="-90 0 0"></a-video>
            </a-marker>
            <a-entity camera="zoom: 1; fov: 60" magicWindowTrackingEnabled></a-entity>
        <style>
            .a-enter-vr {
                display: none;
            }
            #video-entity {
                opacity: 1;
                transition: opacity 0.5s ease-in-out;
            }
        </style>
        <script>
        // Initialize video functionality
        window.addEventListener('load', function() {
            const video = document.getElementById('pawer-logo');
            const videoEntity = document.getElementById('video-entity');
            const marker = document.querySelector('a-marker');
            
            // Make sure video is loaded and ready
            video.load();
            video.muted = false;
            
            // Handle marker found event
            marker.addEventListener('markerFound', function() {
                if (video.paused) {
                    video.play();
                }
                videoEntity.setAttribute('visible', true);
                videoEntity.style.opacity = "1";
            });
            
            // Keep video playing even if marker is lost
            marker.addEventListener('markerLost', function() {
                // Don't pause the video, just manage visibility
                videoEntity.style.opacity = "0.9"; // Slightly fade but keep visible
                // Still ensure the video is playing
                if (video.paused) {
                    video.play();
                }
            });
            
            // Force play on user interaction (needed for mobile)
            document.addEventListener('click', function() {
                if (video.paused) {
                    video.play();
                }
            });
        });
        </script>
        </script>

    </body>
</html>
